# 1 Java内存模型的基础

在并发编程中，需要处理两个关键问题：**线程之间如何通信及线程之间如何同步**（这里的线程是指并发执行的活动实体）。**通信是指线程之间以何种机制来交换信息**。在命令式编程中，**线程之间的通信机制有两种：共享内存和消息传递。**

**Java的并发采用的是共享内存模型**，**Java线程之间的通信总是隐式进行**，整个通信过程对程序员完全透明。

Java线程之间的通信由Java内存模型（本文简称为JMM）控制，JMM决定一个线程对共享变量的写入何时对另一个线程可见。从抽象的角度来看，JMM定义了线程和主内存之间的抽象关系：线程之间的共享变量存储在主内存（Main Memory）中，每个线程都有一个私有的本地内存（Local Memory），本地内存中存储了该线程以读/写共享变量的副本。本地内存是JMM的一个抽象概念，并不真实存在。它涵盖了缓存、写缓冲区、寄存器以及其他的硬件和编译器优化。

![java内存模型的抽象结构示意图](.\pic\java内存模型的抽象结构示意图.png)

果线程A与线程B之间要通信的话，必须要经历下面2个步骤:

1）**线程A把本地内存A中更新过的共享变量刷新到主内存中去。**

2）**线程B到主内存中去读取线程A之前已更新过的共享变量。**